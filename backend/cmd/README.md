# /cmd

このディレクトリには、アプリケーションの各エントリポイント（実行可能なメインパッケージ）を配置します。

## 構成

| ディレクトリ | 役割 | DI | 概要 |
| :--- | :--- | :--- | :--- |
| `http/` | API サーバー | Wire | クリーンアーキテクチャに基づいたレイヤー構造を Wire で結合し、HTTP サーバーを起動します。 |
| `worker/` | バックグラウンドワーカー | 手動 | キューの監視や定期実行タスクを処理します。同一型の別インスタンス生成の可能性を考慮し、手動で DI を行います。 |

---

## 各パッケージの詳細

### 1. http (API Server)
HTTP リクエストを受け付ける API サーバーのエントリポイントです。

- **Dependency Injection (Wire)**:
  複雑なレイヤー（Handler -> Usecase -> Repository）の依存関係を解決するために [google/wire](https://github.com/google/wire) を導入しています。
- **ファイル構成**:
  - `main.go`: サーバーの起動、シグナルハンドリング、設定読み込み。
  - `wire.go`: 依存関係の定義（Injector）。
  - `wire_gen.go`: `wire` コマンドによって自動生成されたコード。
- **更新手順**:
  構造体のコンストラクタ（`New...` 関数）を変更した場合は、以下のコマンドを実行してコードを再生成してください。
  ```bash
  go run [github.com/google/wire/cmd/wire](https://github.com/google/wire/cmd/wire) ./cmd/http
  ```

  ### 2. worker (Background Worker)
  非同期ジョブ・バッチ処理を実行するためのエントリポイントです。

  - DI 方針
  Workerでは、特にQueue/Consumerの部分に置いて、キューのキーのみを切り替えた別インスタンスによって目的を異にする実装が発生する可能性がある。

  Wireでは型ベースの依存関係解決をするので、上記のような分岐が複雑化しやすそうな印象を受けたのでしゅどうDIを採用しています。

  ### 運用上の注意
  できるだけcmd配下のパッケージにはビジネスロジックを直接記載しないように